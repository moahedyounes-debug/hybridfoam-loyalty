<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ููุญุฉ ุงููุดุฑู</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="supervisor.css" />

  <!-- Flatpickr + Chart.js + XLSX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <script src="api.js"></script>
</head>
<body data-theme="dark">

<div class="layout">

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-logo"><img src="logo.png" alt="Logo"></div>
      <div class="brand-text">ููุญุฉ ุงููุดุฑู</div>
    </div>

    <div class="nav-section-title">ุงูุฑุฆูุณูุฉ</div>
    <div class="nav">
      <button class="nav-btn active" data-target="dashboard"><span>Dashboard</span></button>
    </div>

    <div class="nav-section-title">ุงูุนููุงุก</div>
    <div class="nav">
      <button class="nav-btn" data-target="customers"><span>ุจุญุซ ุนููู</span></button>
      <button class="nav-btn" data-target="visits"><span>ุฒูุงุฑุงุช ุงููุฑุน</span></button>
      <button class="nav-btn" data-target="cars"><span>ุณูุงุฑุงุช ุงูุนููู</span></button>
      <button class="nav-btn" data-target="addVisit"><span>ุฅุถุงูุฉ ุฒูุงุฑุฉ</span></button>
    </div>

    <div class="nav-section-title">ุงูุญุฌูุฒุงุช ูุงูุชูุงุฑูุฑ</div>
    <div class="nav">
      <button class="nav-btn" data-target="bookings"><span>ุงูุญุฌูุฒุงุช</span></button>
      <button class="nav-btn" data-target="reports"><span>ุงูุชูุงุฑูุฑ ุงููุงููุฉ</span></button>
      <button class="nav-btn" data-target="export"><span>ุชุตุฏูุฑ Excel</span></button>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">

    <div class="topbar">
      <div class="topbar-left">
        <div class="topbar-title">ููุญุฉ ุงููุดุฑู</div>
        <div class="topbar-sub">ุฅุฏุงุฑุฉ ุงูุนููุงุกุ ุงูุฒูุงุฑุงุชุ ุงูุญุฌูุฒุงุช ูุงูุชูุงุฑูุฑ ุญุณุจ ุงููุฑุน</div>
      </div>

      <div class="topbar-right">
        <div class="branch-pill">ุงููุฑุน ุงูุญุงูู: <span id="currentBranch">โ</span></div>
        <select id="branchSelect" class="branch-select"></select>
        <button id="themeToggle" class="theme-toggle">๐ / โ</button>
      </div>
    </div>

    <div class="content">

      <!-- Dashboard -->
      <section id="dashboard" class="section active">
        <div class="card">
          <div class="card-header"><h2>ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฑุน</h2></div>

          <div class="grid-2">
            <div class="dash-card">
              <div class="dash-card-title">ุฅุฌูุงูู ุงููุจุงูุบ</div>
              <div class="dash-card-value"><span id="mAmount">0</span> ุฑูุงู</div>
            </div>

            <div class="dash-card">
              <div class="dash-card-title">ูุชูุณุท ุงูุฅููุงู ููู ุนููู</div>
              <div class="dash-card-value"><span id="mAvgSpend">0</span> ุฑูุงู</div>
            </div>
          </div>

          <div class="dashboard-grid">
            <div class="dash-card">
              <div class="dash-card-title">ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ</div>
              <div class="bar-row"><div class="bar-label">ุงูุนููุงุก</div><div class="bar-track"><div class="bar-fill" id="barCustomers"></div></div></div>
              <div class="bar-row"><div class="bar-label">ุงูุฒูุงุฑุงุช</div><div class="bar-track"><div class="bar-fill" id="barVisits"></div></div></div>
              <div class="bar-row"><div class="bar-label">ุงููุจุงูุบ</div><div class="bar-track"><div class="bar-fill" id="barAmount"></div></div></div>
            </div>

            <div class="dash-card">
              <div class="dash-card-title">ูุคุดุฑุงุช ุนุงูุฉ</div>
              <p class="status-text">
                ๐ฅ ุงูุนููุงุก: <span id="sCustomers">0</span><br>
                ๐ ุงูุณูุงุฑุงุช: <span id="sCars">0</span><br>
                ๐งพ ุงูุฒูุงุฑุงุช: <span id="sVisits">0</span><br>
                ๐ฐ ุงููุจุงูุบ: <span id="sAmount">0</span> ุฑูุงู
              </p>
            </div>
          </div>

          <div class="charts-grid">
            <div class="dash-card"><div class="dash-card-title">ุงูุฒูุงุฑุงุช ุญุณุจ ุงูููู</div><canvas id="visitsPerDayChart"></canvas></div>
            <div class="dash-card"><div class="dash-card-title">ุฃูุซุฑ ุงูุฎุฏูุงุช</div><canvas id="topServicesChart"></canvas></div>
          </div>
        </div>
      </section>

      <!-- Add Visit -->
      <section id="addVisit" class="section">
        <div class="card">
          <div class="card-header"><h2>ุฅุถุงูุฉ ุฒูุงุฑุฉ</h2></div>

          <div class="card inner-card">
            <div class="card-header"><h3>ุจุญุซ ุนู ุงูุนููู</h3></div>
            <label>ุฑูู ุงูุฌูุงู ุฃู ุงูุนุถููุฉ</label>
            <input id="visitSearch" placeholder="05xxxxxxxx ุฃู 2026xxxx" />
            <button id="visitSearchBtn">ุจุญุซ</button>
          </div>

          <div id="visitCarsBox" class="card inner-card" style="display:none;">
            <div class="card-header"><h3>ุงุฎุชุฑ ุงูุณูุงุฑุฉ</h3></div>
            <div id="visitCarsList" class="list"></div>
          </div>

          <div id="visitForm" class="card inner-card" style="display:none;">
            <div class="card-header"><h3>ุชูุงุตูู ุงูุฒูุงุฑุฉ</h3></div>

            <p id="visitSelectedInfo" class="status-text"></p>

            <label>ุงูุฎุฏูุฉ</label>
            <select id="vService"></select>

            <label>ุงูุณุนุฑ</label>
            <input type="number" id="vPrice" />

            <label>ุงูููุงุท</label>
            <input type="number" id="vPoints" readonly />

            <button id="addServiceBtn" class="btn-secondary">ุฅุถุงูุฉ ุฎุฏูุฉ +</button>

            <div id="servicesList" class="list" style="margin-top:10px;"></div>

            <h3 style="margin-top:15px;">ุงูุฅุฌูุงูู: <span id="totalPrice">0</span> ุฑูุงู</h3>

            <button id="addVisitBtn">ุชุณุฌูู ุงูุฒูุงุฑุฉ</button>
            <p id="addVisitStatus" class="status-text"></p>
          </div>
        </div>
      </section>

    </div>
  </main>
</div>

<script src="supervisor.js"></script>
</body>
</html>
